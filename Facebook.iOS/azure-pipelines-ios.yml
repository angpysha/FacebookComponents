name: $(Build.BuildId)

pool: 
  vmImage: 'macOS-12'

steps:
  - task: UseDotNet@2
    displayName: Install .NET SDK
    inputs:
      packageType: 'sdk'
      version: '7.0.400'
      installationPath: $(Agent.ToolsDirectory)/dotnet
  - task: PowerShell@2
    displayName: Cake nuget packages
    inputs:
      targetType: 'inline'
      script: |
        dotnet new tool-manifest
        dotnet workload install ios
        dotnet tool install Cake.Tool --version 3.1.0
        cd ./Facebook.iOS
        dotnet cake --target nuget
      pwsh: true
  - task: PublishPipelineArtifact@1
    inputs:
      targetPath: '$(Build.SourcesDirectory)/Facebook.iOS/output'
      artifact: 'ios'
      publishLocation: 'pipeline'
  